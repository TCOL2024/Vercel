<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8">
<title>Unterlagen – Bestätigung & Erfassung</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="color-scheme" content="light dark">
<style>
  :root{
    --bg:#f4f7f9; --panel:#fff; --ink:#0e1b2a; --muted:#5d6b7a; --border:#dfe6ee;
    --accent:#1f6ae2; --accent-2:#184db5;
  }
  @media (prefers-color-scheme: dark){
    :root{ --bg:#0c1420; --panel:#0f1b2a; --ink:#e6eef7; --muted:#97a7b8; --border:#243246; }
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.5 system-ui,-apple-system,"Segoe UI",Roboto,Inter,Arial,sans-serif}
  .wrap{max-width:960px;margin:0 auto;padding:28px}
  .hero{background:var(--panel);border:1px solid var(--border);border-radius:18px;padding:36px 28px;box-shadow:0 6px 28px rgba(0,0,0,.06)}
  .h-lead{color:var(--muted);margin:6px 0 0}
  h1{font-size:28px;margin:0 0 6px}
  h2{font-size:22px;margin:32px 0 10px}
  p{margin:0 0 14px}
  .note{background:#eef4ff22;border:1px solid var(--border);padding:16px;border-radius:14px}
  .confirm{display:flex;gap:10px;align-items:flex-start;margin-top:12px}
  .confirm input{margin-top:3px}
  .actions{margin-top:18px;display:flex;gap:12px;flex-wrap:wrap}
  .btn{appearance:none;border:0;border-radius:12px;padding:12px 16px;font-weight:700;cursor:pointer}
  .primary{background:linear-gradient(135deg,var(--accent),var(--accent-2));color:#fff}
  .ghost{background:transparent;border:1px solid var(--border);color:inherit}
  .disabled{opacity:.6;cursor:not-allowed}
  /* Step 2 – „Allianz“-artige Inputs */
  .card{margin-top:22px;background:var(--panel);border:1px solid var(--border);border-radius:18px;padding:28px}
  .field{margin:22px 0}
  .label{font-weight:600;margin-bottom:8px}
  .line{
    width:100%; background:transparent; border:0; border-bottom:2px solid var(--border);
    padding:12px 4px; font-size:18px; color:inherit; outline:none;
  }
  .line:focus{border-bottom-color:var(--accent)}
  select.line{padding-left:0}
  .row{display:grid;grid-template-columns:1fr;gap:18px}
  @media(min-width:760px){ .row{grid-template-columns:1fr 1fr} }
  .err{display:none;margin-top:12px;padding:10px;border-radius:10px;background:rgba(239,68,68,.12);color:#b91c1c}
  .ok{display:none;margin-top:12px;padding:10px;border-radius:10px;background:rgba(16,185,129,.12);color:#047857}
  .subtle{color:var(--muted);font-size:14px}
  /* hide file input if später ergänzt – strukturell vorbereitet */
  iframe[name="silentTarget"]{display:none}
</style>
</head>
<body>
  <div class="wrap">
    <!-- Schritt 1: Belehrung -->
    <section class="hero" id="step1">
      <header>
        <div class="subtle" style="letter-spacing:.06em;text-transform:uppercase">Hinweis</div>
        <h1>Bitte bestätigen Sie vorab die rechtlichen Hinweise</h1>
        <p class="h-lead">Erst nach Ihrer Bestätigung werden die Eingabefelder angezeigt.</p>
      </header>

      <div class="note">
        <p><strong>Belehrung / Bestätigung</strong></p>
        <p>Ich bestätige, dass die von mir hochgeladenen bzw. übermittelten Inhalte und Dateien
           <strong>keine Urheber-, Leistungsschutz-, Marken- oder Persönlichkeitsrechte Dritter verletzen</strong>,
           dass ich zur Nutzung, Weitergabe und Verarbeitung berechtigt bin und dass in den Unterlagen
           keine schutzbedürftigen Daten enthalten sind, die ich nicht weitergeben darf.</p>
        <p>Ich versichere ferner, dass ich die einschlägigen gesetzlichen Vorgaben (u. a. Urheberrecht,
           Datenschutz/DSGVO) beachte und die Inhalte frei von Malware sind.</p>
      </div>

      <label class="confirm">
        <input id="consent" type="checkbox" />
        <span>Ich habe die Belehrung gelesen und <strong>stimme zu</strong>.</span>
      </label>

      <div class="actions">
        <button id="next" class="btn primary disabled" disabled>Weiter zur Datenerfassung</button>
        <button id="cancel" class="btn ghost" type="button">Abbrechen</button>
      </div>
      <div id="warn" class="err" role="alert">Bitte die Belehrung zuerst bestätigen.</div>
    </section>

    <!-- Schritt 2: Erfassung -->
    <section id="step2" class="card" style="display:none">
      <header style="margin-bottom:8px">
        <div class="subtle" style="letter-spacing:.06em;text-transform:uppercase">Angaben</div>
        <h2>Erfassung der Teilnehmerdaten</h2>
        <p class="subtle">Die Felder orientieren sich am Stil des zweiten Screenshots.</p>
      </header>

      <!-- unsichtbares Ziel für klassischen POST (robust, kein CORS) -->
      <iframe name="silentTarget"></iframe>

      <form id="form" action="DEIN_WEBHOOK_HIER" method="POST" enctype="multipart/form-data" target="silentTarget" novalidate>
        <div class="row">
          <div class="field">
            <div class="label">Vorname *</div>
            <input class="line" type="text" name="vorname" id="vorname" required autocomplete="given-name" maxlength="100">
          </div>
          <div class="field">
            <div class="label">Nachname *</div>
            <input class="line" type="text" name="nachname" id="nachname" required autocomplete="family-name" maxlength="100">
          </div>
        </div>

        <div class="field">
          <div class="label">E-Mail-Adresse *</div>
          <input class="line" type="email" name="email" id="email" required placeholder="name@beispiel.de" inputmode="email" maxlength="200">
        </div>

        <div class="row">
          <div class="field">
            <div class="label">Kurs *</div>
            <select class="line" name="kurs" id="kurs" required>
              <option value="" disabled selected>Bitte auswählen …</option>
              <option>PFK</option>
              <option>Wirtschaftsfachwirte</option>
              <option>Bilanzbuchhalter</option>
              <option>Ausbildereignung</option>
              <option>Bachelor Prof. Versicherung und Finanzanlagen</option>
              <option>Sonstige</option>
            </select>
          </div>
          <div class="field">
            <div class="label">Fachrichtung *</div>
            <select class="line" name="fachrichtung" id="fachrichtung" required>
              <option value="" disabled selected>Bitte auswählen …</option>
              <option>Personal</option>
              <option>Ausbildung</option>
              <option>Volkswirtschaft</option>
              <option>Betriebswirtschaft</option>
              <option>Recht</option>
              <option>Kommunikation</option>
              <option>Sonstige</option>
            </select>
          </div>
        </div>

        <!-- Hidden Felder für Make/SharePoint Routing -->
        <input type="hidden" name="consent" value="yes">
        <input type="hidden" name="intent" value="create_list_entry">
        <input type="hidden" name="source" value="Upload-Form v2 (consent-first)">
        <input type="hidden" name="timestamp" id="ts">

        <div class="actions">
          <button class="btn primary" id="submitBtn">Eintrag erstellen</button>
          <button class="btn ghost" type="reset">Zurücksetzen</button>
        </div>

        <div id="ok" class="ok">✅ Gesendet – Eintrag wird angelegt.</div>
        <div id="err2" class="err">❌ Bitte alle Pflichtfelder prüfen.</div>
      </form>
    </section>
  </div>

<script>
  // Schritt 1: Freischalten von Schritt 2
  const consent = document.getElementById('consent');
  const nextBtn = document.getElementById('next');
  const warn = document.getElementById('warn');
  const step1 = document.getElementById('step1');
  const step2 = document.getElementById('step2');

  consent.addEventListener('change', () => {
    const ok = consent.checked;
    nextBtn.disabled = !ok;
    nextBtn.classList.toggle('disabled', !ok);
    warn.style.display = 'none';
  });

  document.getElementById('cancel').addEventListener('click', () => {
    window.history.length > 1 ? history.back() : window.close();
  });

  nextBtn.addEventListener('click', () => {
    if (!consent.checked) { warn.style.display = 'block'; return; }
    step1.style.display = 'none';
    step2.style.display = 'block';
    document.getElementById('ts').value = new Date().toISOString();
    document.getElementById('vorname').focus();
  });

  // Schritt 2: einfache Validierung vor POST
  const form = document.getElementById('form');
  const okMsg = document.getElementById('ok');
  const err2 = document.getElementById('err2');
  form.addEventListener('submit', (e) => {
    err2.style.display = 'none';
    if (!form.checkValidity()) { e.preventDefault(); err2.style.display = 'block'; return; }
    okMsg.style.display = 'block';
    setTimeout(()=> okMsg.style.display='none', 3000);
  });
</script>
</body>
</html>
