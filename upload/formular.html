<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8">
<title>Unterlagen-Upload (Einzeldatei)</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  :root{--bg:#f6f7fb;--panel:#fff;--ink:#0f1720;--muted:#667085;--border:#e6e8f0;--accent:#2563eb}
  *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.5 system-ui,-apple-system,"Segoe UI",Inter,Roboto,Arial,sans-serif}
  .wrap{max-width:880px;margin:0 auto;padding:28px}
  .card{background:var(--panel);border:1px solid var(--border);border-radius:16px;padding:24px;box-shadow:0 8px 30px rgba(2,6,23,.06)}
  h1{margin:0 0 6px;font-size:26px} .lede{color:var(--muted);margin:0 0 18px}
  .row{display:grid;gap:16px} @media(min-width:760px){.row.cols-2{grid-template-columns:1fr 1fr}}
  .field{margin:16px 0 2px} .label{font-weight:600;margin-bottom:6px}
  .line{width:100%;border:1px solid var(--border);border-radius:10px;padding:12px;background:transparent;font-size:16px}
  .line:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px rgba(37,99,235,.15)}
  textarea{min-height:110px;resize:vertical}
  .drop{border:2px dashed var(--border);border-radius:12px;padding:22px;text-align:center;background:#f8fafc;cursor:pointer}
  .drop:hover{border-color:var(--accent);background:#eef6ff}
  #file{display:none}
  .actions{display:flex;gap:12px;flex-wrap:wrap;margin-top:16px}
  .btn{appearance:none;border:1px solid var(--border);border-radius:10px;padding:12px 16px;font-weight:700;cursor:pointer;background:#fff}
  .primary{background:var(--accent);color:#fff;border-color:var(--accent)}
  .note,.err{display:none;margin-top:12px;padding:10px;border-radius:10px}
  .note{background:#ecfdf5;color:#065f46} .err{background:#fef2f2;color:#991b1b}
  iframe[name="silentTarget"]{display:none}

  /* Overlay */
  .overlay{position:fixed;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:50}
  .ov-card{max-width:650px;background:#fff;color:#0f1720;border-radius:16px;padding:24px;border:1px solid #e5e7eb}
  .ov-card h2{margin:0 0 8px} .ov-card p{margin:8px 0}
  .ov-cta{display:flex;gap:10px;justify-content:flex-end;margin-top:12px}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>üì§ Unterlagen-Upload</h1>
    <p class="lede">Pro Vorgang genau <strong>eine</strong> Datei hochladen. Wenn du mehrere Dateien hast, lade sie nacheinander hoch ‚Äì deine Eingaben bleiben erhalten.</p>

    <!-- verstecktes Ziel f√ºr klassischen POST (kein Reload, Felder bleiben) -->
    <iframe name="silentTarget"></iframe>

    <form id="form" action="https://hook.us2.make.com/qlecolu10q72phwu7i8ksnvcypx67qe4" method="POST" enctype="multipart/form-data" target="silentTarget" novalidate>
      <!-- Pflichtfelder -->
      <div class="row cols-2">
        <div class="field"><div class="label">Vorname *</div><input class="line" type="text" name="vorname" id="vorname" required></div>
        <div class="field"><div class="label">Nachname *</div><input class="line" type="text" name="nachname" id="nachname" required></div>
      </div>
      <div class="field"><div class="label">E-Mail-Adresse *</div><input class="line" type="email" name="email" id="email" required placeholder="name@beispiel.de"></div>

      <div class="row cols-2">
        <div class="field">
          <div class="label">Kurs *</div>
          <select class="line" name="kurs" id="kurs" required>
            <option value="" disabled selected>Bitte ausw√§hlen ‚Ä¶</option>
            <option>PFK</option><option>Wirtschaftsfachwirte</option><option>Bilanzbuchhalter</option>
            <option>Ausbildereignung</option><option>Bachelor Prof. Versicherung und Finanzanlagen</option><option>Sonstige</option>
          </select>
        </div>
        <div class="field">
          <div class="label">Fachrichtung *</div>
          <select class="line" name="fachrichtung" id="fachrichtung" required>
            <option value="" disabled selected>Bitte ausw√§hlen ‚Ä¶</option>
            <option>Personal</option><option>Ausbildung</option><option>Volkswirtschaft</option>
            <option>Betriebswirtschaft</option><option>Recht</option><option>Kommunikation</option><option>Sonstige</option>
          </select>
        </div>
      </div>

      <div class="field"><div class="label">Beschreibung / Hinweise (optional)</div>
        <textarea class="line" name="beschreibung" id="beschreibung" placeholder="Kurzbeschreibung, Kontext, Version ‚Ä¶"></textarea>
      </div>

      <!-- Rechtshinweis -->
      <div class="field">
        <label class="label" style="font-weight:700">Best√§tigung *</label>
        <label style="display:flex;gap:10px;align-items:flex-start">
          <input type="checkbox" name="consent" id="consent" value="yes" required>
          <span>Ich best√§tige, dass die von mir hochgeladenen Dateien keine Urheber-, Marken- oder Pers√∂nlichkeitsrechte Dritter verletzen, ich zur Nutzung berechtigt bin und die gesetzlichen Vorgaben (u. a. Urheberrecht, DSGVO) beachte.</span>
        </label>
      </div>

      <!-- Einzeldatei -->
      <div class="field">
        <div class="label">Datei (max. 25 MB) *</div>
        <div id="drop" class="drop" role="button" tabindex="0" aria-label="Datei ausw√§hlen">
          <strong>Hier klicken, um eine Datei zu w√§hlen</strong><br>
          <small style="color:#667085">Erlaubt: PDF, DOCX, PPTX, XLSX, JPG/PNG, HTML</small>
          <input id="file" name="file" type="file" accept=".pdf,.docx,.pptx,.xlsx,.jpg,.jpeg,.png,.html,.htm" required>
        </div>
        <div id="picked" class="lede" style="display:none;margin-top:8px"></div>
      </div>

      <!-- Routing/Meta -->
      <input type="hidden" name="intent" value="create_list_entry_and_upload_single">
      <input type="hidden" name="source" value="Upload-Form Single v1">
      <input type="hidden" name="timestamp" id="ts">

      <div class="actions">
        <button type="button" class="btn" id="clearFile">Neue Datei ausw√§hlen</button>
        <button class="btn primary" id="sendBtn">Senden</button>
      </div>

      <div id="ok" class="note">‚úÖ Upload gestartet. Du kannst danach direkt die n√§chste Datei w√§hlen ‚Äì die Felder bleiben erhalten.</div>
      <div id="err" class="err">‚ùå Bitte Pflichtfelder pr√ºfen und eine Datei w√§hlen (max. 25 MB).</div>
    </form>
  </div>
</div>

<!-- Overlay: Hinweis ‚Äûeine Datei pro Vorgang‚Äú -->
<div id="overlay" class="overlay" role="dialog" aria-modal="true">
  <div class="ov-card">
    <h2>Hinweis zum Upload</h2>
    <p>Pro Vorgang kann <strong>genau eine Datei</strong> hochgeladen werden.</p>
    <p>Wenn du mehrere Dateien hast, lade sie bitte <strong>nacheinander</strong> hoch. Deine Angaben (Name, Kurs, Fachrichtung etc.) bleiben auf der Seite erhalten ‚Äì du musst sie nicht erneut eingeben.</p>
    <div class="ov-cta">
      <button id="ovClose" class="btn primary">Verstanden</button>
    </div>
  </div>
</div>

<script>
  // Overlay
  const ov = document.getElementById('overlay');
  document.getElementById('ovClose').addEventListener('click', ()=>{ ov.style.display='none'; document.getElementById('vorname').focus(); });

  // Timestamp
  document.getElementById('ts').value = new Date().toISOString();

  // Datei-Auswahl UI (Einzeldatei)
  const drop = document.getElementById('drop');
  const fileInput = document.getElementById('file');
  const picked = document.getElementById('picked');
  const clearBtn = document.getElementById('clearFile');

  function showPicked(){
    if(fileInput.files && fileInput.files[0]){
      const f = fileInput.files[0];
      picked.style.display='block';
      picked.textContent = `Ausgew√§hlt: ${f.name} (${(f.size/1024/1024).toFixed(2)} MB)`;
    } else {
      picked.style.display='none';
      picked.textContent = '';
    }
  }
  drop.addEventListener('click', ()=> fileInput.click());
  fileInput.addEventListener('change', showPicked);
  clearBtn.addEventListener('click', ()=>{
    fileInput.value = ''; showPicked();
  });

  // Validierung + klassischer POST ins iframe (Felder bleiben)
  const form = document.getElementById('form');
  const ok = document.getElementById('ok');
  const err = document.getElementById('err');
  const MAX_MB = 25;

  form.addEventListener('submit', (e)=>{
    err.style.display='none';
    // Pflichtfelder pr√ºfen
    if(!form.checkValidity()){ e.preventDefault(); err.style.display='block'; return; }
    const f = fileInput.files[0];
    if(!f){ e.preventDefault(); err.textContent='‚ùå Bitte eine Datei w√§hlen.'; err.style.display='block'; return; }
    if(f.size > MAX_MB*1024*1024){ e.preventDefault(); err.textContent=`‚ùå Datei gr√∂√üer als ${MAX_MB} MB.`; err.style.display='block'; return; }
    ok.style.display='block';
    // Felder NICHT zur√ºcksetzen -> der/die Nutzer:in kann direkt neue Datei w√§hlen
    setTimeout(()=> ok.style.display='none', 3000);
  });
</script>
</body>
</html>
