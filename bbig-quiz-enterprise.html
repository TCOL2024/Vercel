<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>BBiG-Quiz Professional</title>
<script src="https://cdn.tailwindcss.com"></script>
<script defer src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
:root{--primary:#0066CC;--primary-dark:#004C99;--accent:#FF6B35;--success:#00C853;--warning:#FFB300;--surface:#FFF;--surface-alt:#F8F9FA;--ink:#1A1D23;--ink-light:#4A5568;--ink-muted:#718096;--border:#DEE2E6;--shadow-sm:0 1px 3px rgba(0,0,0,.08);--shadow-md:0 4px 12px rgba(0,0,0,.1);--shadow-lg:0 8px 24px rgba(0,0,0,.15);--radius:8px;--radius-lg:12px}
html.dark{--surface:#1A1D23;--surface-alt:#242830;--ink:#FFF;--ink-light:#CBD5E0;--ink-muted:#A0AEC0;--border:#3A4150}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:Inter,system-ui,sans-serif;font-size:14px;line-height:1.6;background:var(--surface-alt);color:var(--ink)}
.container{max-width:1200px;margin:0 auto;padding:0 20px}
.card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-lg);box-shadow:var(--shadow-sm);transition:all .2s}
.btn{display:inline-flex;align-items:center;gap:8px;padding:10px 18px;border-radius:var(--radius);border:1px solid var(--border);background:var(--surface);color:var(--ink);font-weight:600;font-size:13px;cursor:pointer;transition:all .2s;white-space:nowrap}
.btn:hover:not(:disabled){background:var(--surface-alt);border-color:var(--primary);transform:translateY(-1px)}
.btn:disabled{opacity:.5;cursor:not-allowed}
.btn-primary{background:var(--accent);border-color:var(--accent);color:#fff;font-weight:700}
.btn-primary:hover:not(:disabled){background:#E55A2B}
.btn-blue{background:var(--primary);border-color:var(--primary);color:#fff;font-weight:700}
.btn-blue:hover:not(:disabled){background:var(--primary-dark)}
.btn-ghost{background:transparent;border:none}
.badge{display:inline-flex;align-items:center;gap:6px;padding:4px 12px;border-radius:16px;font-size:11px;font-weight:700;background:#E3F2FD;color:var(--primary)}
.progress-outer{height:10px;border-radius:5px;background:var(--surface-alt);overflow:hidden;border:1px solid var(--border)}
.progress-inner{height:100%;background:linear-gradient(90deg,var(--primary),#3385D6);transition:width .4s}
.hero{background:linear-gradient(135deg,#E3F2FD 0%,#FFF 100%);border-bottom:3px solid var(--primary);padding:40px 20px;text-align:center}
html.dark .hero{background:linear-gradient(135deg,#1A1D23 0%,#242830 100%)}
.hero h1{font-size:32px;font-weight:800;color:var(--primary);margin-bottom:8px;letter-spacing:-.5px}
.tabs{display:flex;gap:10px;overflow-x:auto;scrollbar-width:none;padding:4px 0}
.tabs::-webkit-scrollbar{display:none}
.tab{padding:10px 18px;border:1px solid var(--border);border-radius:var(--radius);background:var(--surface);cursor:pointer;display:flex;align-items:center;gap:8px;font-weight:600;white-space:nowrap;transition:all .2s}
.tab:hover{border-color:var(--primary);background:var(--surface-alt)}
.tab[aria-selected="true"]{background:var(--primary);color:#fff;border-color:var(--primary)}
.q-card{position:relative;padding:24px}
.bookmark{position:absolute;top:20px;right:20px;width:36px;height:36px;border-radius:50%;display:grid;place-items:center;background:var(--surface-alt);border:1px solid var(--border);cursor:pointer;transition:all .2s}
.bookmark:hover,.bookmark.active{background:var(--accent);border-color:var(--accent);transform:scale(1.1)}
.tip{background:#E3F2FD;border-left:4px solid var(--primary);padding:14px;border-radius:var(--radius);margin-top:12px}
html.dark .tip{background:rgba(0,102,204,.15)}
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(6px);display:none;z-index:98}
.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;padding:20px;z-index:99}
.modal.open,.modal-backdrop.open{display:flex}
.panel{width:100%;max-width:900px;max-height:90vh;overflow:auto;border-radius:var(--radius-lg)}
#toast{position:fixed;left:50%;bottom:24px;transform:translateX(-50%);background:var(--ink);color:#fff;padding:14px 24px;border-radius:var(--radius);font-weight:600;z-index:100;display:none;box-shadow:var(--shadow-md)}
.sticky-actions{position:fixed;bottom:0;left:0;right:0;background:var(--surface);border-top:2px solid var(--primary);padding:14px 0;z-index:50;box-shadow:0 -4px 12px rgba(0,0,0,.08)}
#clusterSelect{display:none}
@media (max-width:768px){.tabs{display:none}#clusterSelect{display:block}.hero h1{font-size:24px}}
.hidden{display:none!important}
@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}
#loginScreen{position:fixed;inset:0;background:linear-gradient(135deg,#E3F2FD 0%,#F5F7FA 100%);display:flex;align-items:center;justify-content:center;z-index:1000;padding:20px}
html.dark #loginScreen{background:linear-gradient(135deg,#1A1D23 0%,#242830 100%)}
.login-container{width:100%;max-width:520px;animation:slideUp .5s cubic-bezier(.34,1.56,.64,1)}
@keyframes slideUp{from{transform:translateY(30px);opacity:0}to{transform:translateY(0);opacity:1}}
.login-logo{width:80px;height:80px;margin:0 auto 24px;background:linear-gradient(135deg,var(--primary),var(--primary-dark));border-radius:var(--radius-lg);display:grid;place-items:center;box-shadow:var(--shadow-lg)}
.login-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-lg);box-shadow:var(--shadow-lg);padding:40px}
.input-group{margin-bottom:20px}
.input-group label{display:block;font-weight:600;font-size:13px;margin-bottom:8px;color:var(--ink-light)}
.input-group input{width:100%;padding:14px 16px;border:2px solid var(--border);border-radius:var(--radius);font-size:15px;font-weight:500;transition:all .2s;background:var(--surface);color:var(--ink);font-family:inherit}
.input-group input:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px rgba(0,102,204,.1)}
.disclaimer-box{background:#FFF9E6;border:1px solid #FFD54F;border-radius:var(--radius);padding:16px;margin-bottom:24px}
html.dark .disclaimer-box{background:rgba(255,179,0,.1);border-color:rgba(255,179,0,.3)}
.disclaimer-box h4{font-weight:700;font-size:13px;color:#F57C00;margin-bottom:8px;display:flex;align-items:center;gap:6px}
.disclaimer-box p{font-size:12px;line-height:1.6;color:var(--ink-light);margin-bottom:12px}
.disclaimer-box label{display:flex;align-items:start;gap:10px;cursor:pointer;font-size:12px;font-weight:600}
.disclaimer-box input[type="checkbox"]{margin-top:2px;width:18px;height:18px;cursor:pointer;accent-color:var(--primary);flex-shrink:0}
.login-features{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:24px;padding-top:24px;border-top:1px solid var(--border)}
.feature-item{display:flex;align-items:center;gap:8px;font-size:12px;color:var(--ink-muted)}
.feature-item i{width:16px;height:16px;color:var(--primary);flex-shrink:0}
</style>
</head>
<script>
document.addEventListener("DOMContentLoaded", () => {
  if (window.lucide) lucide.createIcons();
  if (window.marked) marked.setOptions({ breaks: true, gfm: true });

  // ===== KONFIGURATION (Make.com Webhook) =====
  const WEBHOOK_URL = "/api/linda-proxy"; // Deine Make.com URL oder Vercel Proxy
  const CURRENT_USER_KEY = "BBIG_CURRENT_USER";
  
  const getStorageKey = (key) => {
    const username = localStorage.getItem(CURRENT_USER_KEY) || "default";
    return `BBIG_${username}_${key}`;
  };

  // ===== UI ELEMENTS =====
  const loginScreen = document.getElementById("loginScreen");
  const mainApp = document.getElementById("mainApp");
  const loginForm = document.getElementById("loginForm");
  const usernameInput = document.getElementById("usernameInput");
  const disclaimerCheck = document.getElementById("disclaimerCheck");
  const currentUserDisplay = document.getElementById("currentUser");
  const logoutBtn = document.getElementById("logoutBtn");
  const form = document.getElementById("form");
  const progressBar = document.getElementById("progressBar");
  const progressTxt = document.getElementById("progressText");
  const selText = document.getElementById("selText");
  const submitBtn = document.getElementById("submitBtn");
  const resetBtn = document.getElementById("resetBtn");
  const timerEl = document.getElementById("timer");
  const resultWrap = document.getElementById("resultWrap");
  const aiResult = document.getElementById("aiResult");
  const toastEl = document.getElementById("toast");
  const tabs = document.getElementById("tabs");
  const clusterSelect = document.getElementById("clusterSelect");
  const bookmarksBtn = document.getElementById("bookmarksBtn");
  const bookmarkCount = document.getElementById("bookmarkCount");
  const bmBackdrop = document.getElementById("bmBackdrop");
  const bmModal = document.getElementById("bmModal");
  const bmClose = document.getElementById("bmClose");
  const bmList = document.getElementById("bmList");
  const quickBtn = document.getElementById("quickBtn");
  const qlBackdrop = document.getElementById("qlBackdrop");
  const qlModal = document.getElementById("qlModal");
  const qlClose = document.getElementById("qlClose");
  const qlSearch = document.getElementById("qlSearch");
  const qlList = document.getElementById("qlList");
  const historyBtn = document.getElementById("historyBtn");
  const histBackdrop = document.getElementById("histBackdrop");
  const histModal = document.getElementById("histModal");
  const histClose = document.getElementById("histClose");
  const histList = document.getElementById("histList");
  const themeToggle = document.getElementById("themeToggle");

  // ===== FRAGEN (100 insgesamt - 10 Cluster) =====
  const BANK_CORE = [
    { ref:"V1", q:"Nenne vier Pflichtangaben im Berufsausbildungsvertrag.", tip:["ยง11 BBiG: Parteien, Beginn/Dauer, Ziel, Gliederung, Vergรผtung, Probezeit, Urlaub, Kรผndigung."]},
    { ref:"V2", q:"Drei Kernpunkte einer Ausbildungsordnung?", tip:["Berufsbild, Rahmenplan/Dauer, Prรผfungen (ยงยง4-5 BBiG)."]},
    { ref:"V3", q:"Probezeit: Dauer & Zweck?", tip:["Mind. 1, max. 4 Monate; Eignungsprรผfung (ยง20 BBiG)."]},
    { ref:"V4", q:"Wer unterschreibt bei Minderjรคhrigen?", tip:["Beide Sorgeberechtigte + Azubi (ยง10 BBiG, BGB)."]},
    { ref:"V5", q:"Berufsschulzeit U18 vs. โฅ18?", tip:["U18: besondere Anrechnung (JArbSchG); Wege zรคhlen (ยง15 BBiG)."]},
    { ref:"V6", q:"Ruhezeit Jugendliche?", tip:["Mind. 12 Std (JArbSchG)."]},
    { ref:"V7", q:"Angemessene Vergรผtung?", tip:["MiAV Untergrenze; Tarif/branchenรผblich; Steigerung (ยง17 BBiG)."]},
    { ref:"V8", q:"รberstunden zulรคssig?", tip:["Nur ausbildungsdienlich; Vergรผtung/Ausgleich; Schutz beachten."]},
    { ref:"V9", q:"Betrieblicher Ausbildungsplan?", tip:["Umsetzung Rahmenplan; zeitl./sachl. Gliederung; Qualitรคt."]},
    { ref:"V10", q:"Berichtsheft?", tip:["Zulassungsvoraussetzung; elektronisch mรถglich; Kontrolle (ยง13 BBiG)."]}
  ];
  
  const BANK_BASICS = [
    { ref:"G1", q:"Jugendberufsagentur: Aufgabe?", tip:["U25 unterstรผtzen; AA/Jobcenter/Kommunen."]},
    { ref:"G2", q:"Drei Argumente fรผr Ausbildung?", tip:["Fachkrรคfte, Flexibilitรคt, Innovation."]},
    { ref:"G3", q:"Personalplanung: Dimensionen?", tip:["Quantitativ, qualitativ, zeitlich."]},
    { ref:"G4", q:"Vier Recruiting-Wege?", tip:["Schulen, Social, Messen, Empfehlungen."]},
    { ref:"G5", q:"Auswahlprozess: Elemente?", tip:["Screening, Gesprรคch/Test, Entscheidung."]},
    { ref:"G6", q:"Drei Motive fรผr Ausbildung?", tip:["Interesse, Unabhรคngigkeit, Perspektive."]},
    { ref:"G7", q:"Drei Kompetenzfelder?", tip:["Fachlich, sozial, persรถnlich."]},
    { ref:"G8", q:"Eignung prรผfen (wie)?", tip:["Zeugnisse, Tests, Beobachtung."]},
    { ref:"G9", q:"Nachhaltigkeit in Ausbildung?", tip:["Lernziele/Projekte; Rolle Ausbilder."]},
    { ref:"G10", q:"SDGs: Was & Nutzen?", tip:["17 globale Ziele; Orientierung."]}
  ];
  
  const BANK_RECHT = [
    { ref:"R1", q:"Art.12 GG: Garantie?", tip:["Freie Wahl Beruf/Ausbildung; einschrรคnkbar."]},
    { ref:"R2", q:"AGG ยง1: Ziel?", tip:["Benachteiligungen verhindern."]},
    { ref:"R3", q:"AGG ยง2: Anwendung Ausbildung?", tip:["Zugang zu Berufsbildung."]},
    { ref:"R4", q:"ยง1 BBiG: Vier Sรคulen?", tip:["Vorbereitung, Ausbildung, Fortbildung, Umschulung."]},
    { ref:"R5", q:"BvB: Zweck?", tip:["Heranfรผhrung; Basis Handlungsfรคhigkeit."]},
    { ref:"R6", q:"EQ: Was & wer?", tip:["Langzeitpraktikum SGB III; junge Bewerbende."]},
    { ref:"R7", q:"MiAV & Tarif?", tip:["MiAV Untergrenze; Tarif maรgeblich."]},
    { ref:"R8", q:"Gรผnstigkeitsprinzip?", tip:["Abweichungen nur zugunsten Beschรคftigter."]},
    { ref:"R9", q:"Nachweis: Rolle Zulassung?", tip:["Kann gefordert werden; fehlend kann ausschlieรen."]},
    { ref:"R10", q:"ยง28 BBiG: Durchfรผhrung?", tip:["Eignung; moderne Formen ok."]}
  ];
  
  const BANK_ARBZ = [
    { ref:"A1", q:"U18: Arbeitszeit?", tip:["8 h/Tag, 40 h/W (Ausnahmen)."]},
    { ref:"A2", q:"U18: Pausen?", tip:[">4,5-6h: 30 Min; >6h: 60 Min."]},
    { ref:"A3", q:"U18: Ruhezeit?", tip:["Mind. 12 Std."]},
    { ref:"A4", q:"U18: Sonn-/Feiertag?", tip:["Verbot; Ausnahmen; 2 freie Sonntage/Monat."]},
    { ref:"A5", q:"โฅ18: Arbeitszeit ArbZG?", tip:["8 h/Tag; bis 10 mit Ausgleich."]},
    { ref:"A6", q:"โฅ18: Pausen/Ruhe?", tip:["6-9h: 30 Min; >9h: 45 Min; 11h Ruhe."]},
    { ref:"A7", q:"Mehrarbeit Doku?", tip:[">8 h/Tag; 2 Jahre (ยง16 ArbZG)."]},
    { ref:"A8", q:"Urlaub BUrlG?", tip:["20 AT (4 Wochen) 5-Tage-Woche."]},
    { ref:"A9", q:"Urlaub U18?", tip:["u16:30 WT; u17:27; u18:25; โฅ18:24 WT."]},
    { ref:"A10", q:"ยง15 BBiG: Freistellung?", tip:["Unterricht/Prรผfungen; Wegezeiten."]}
  ];
  
  const BANK_ORGA = [
    { ref:"O1", q:"Vollstรคndige Handlung: Schritte?", tip:["Informieren, Planen, Entscheiden, Ausfรผhren, Kontrollieren, Bewerten."]},
    { ref:"O2", q:"Lernzielebenen?", tip:["Richt (Gebiet), Grob (Fรคhigkeit), Fein (Teilziel)."]},
    { ref:"O3", q:"Sachliche Gliederung: Kriterien?", tip:["Einheiten, รberschaubarkeit, Probezeit nutzbar."]},
    { ref:"O4", q:"Zeitliche Gliederung: Kriterien?", tip:["Prรผfungstermine, Reihenfolge, Block/Urlaub."]},
    { ref:"O5", q:"Pflichten ยง11/13/14?", tip:["Gliederung; Nachweis; Lernziele."]},
    { ref:"O6", q:"Versetzungsplan: Nutzen?", tip:["Steuerung Stationen; Lernziele."]},
    { ref:"O7", q:"Digitale Tools: Vorteile?", tip:["Transparenz; Feedback/Nachverfolgung."]},
    { ref:"O8", q:"Qualitรคtssicherung: Prรผfung?", tip:["Zwischengesprรคche, Zielabgleich."]},
    { ref:"O9", q:"Verkรผrzung: Wann?", tip:["Vorbildung/Leistung; Einvernehmen (ยง8 BBiG)."]},
    { ref:"O10", q:"Teilzeit: Funktion?", tip:["Reduzierte Zeiten; Lernziel bleibt (ยง7a)."]}
  ];
  
  const BANK_BETEILIGTE = [
    { ref:"B1", q:"Beteiligte nennen.", tip:["Ausbildende, Ausbilder, Beauftragte, Azubis, IHK, Eltern."]},
    { ref:"B2", q:"Eignung Betrieb?", tip:["Ausstattung, Plan, Plรคtze/Schutz."]},
    { ref:"B3", q:"Fachkraftbegriff?", tip:["Abschluss oder 2ร Zeit Tรคtigkeit."]},
    { ref:"B4", q:"Relation FK:Azubis?", tip:["1-2:1; 3-5:2; 6-8:3; +3 FK:+1 Azubi."]},
    { ref:"B5", q:"Pflichten Ausbildende ยง14?", tip:["Lernziele, Schutz, Freistellung, Zeugnis."]},
    { ref:"B6", q:"Rolle Ausbilder?", tip:["Planung, Durchfรผhrung, Kontrolle, Coaching."]},
    { ref:"B7", q:"Beauftragte: Aufgabe?", tip:["Teilqualifikationen vermitteln (ยง28(3))."]},
    { ref:"B8", q:"Persรถnliche Eignung: Fehlt wann?", tip:["Wiederholte JArbSchG-Verstรถรe."]},
    { ref:"B9", q:"Kรผndigung: Regeln?", tip:["Probezeit: jederzeit (ยง22(1)); danach: wichtiger Grund/4 Wochen."]},
    { ref:"B10", q:"Mutterschutz: Regeln?", tip:["MuSchG: Schutzfristen, Verbote, Kรผndigungsschutz."]}
  ];
  
  const BANK_MITBEST = [
    { ref:"M1", q:"BR: Rechte BBiG?", tip:["ยง96 Beratung; ยง98 Mitbestimmung/Bestellung."]},
    { ref:"M2", q:"ยง87 BetrVG: Themen?", tip:["Arbeitszeit, Ordnung, Vergรผtung, IT."]},
    { ref:"M3", q:"Einstellung Azubis: BR?", tip:["ยง99: Unterrichten, Unterlagen, Zustimmung."]},
    { ref:"M4", q:"JAV: Hauptaufgaben?", tip:["รberwachung & Initiativen Jugend/Azubis."]},
    { ref:"M5", q:"JAV Wahl: Wer?", tip:["u18 + Azubis; wรคhlbar <25; BR ausgeschlossen."]},
    { ref:"M6", q:"JAV Grรถรe: Abhรคngig von?", tip:["Zahl Wahlberechtigter (ยง62 BetrVG)."]},
    { ref:"M7", q:"BR Widerspruch: Wann?", tip:["Fehlende Eignung (ยง98(2))."]},
    { ref:"M8", q:"Nichteinigung: Lรถsung?", tip:["Einigungsstelle."]},
    { ref:"M9", q:"Nachteilsausgleich: Unterstรผtzung?", tip:["Zeit/Hilfsmittel auf Antrag."]},
    { ref:"M10", q:"Ausland: Mรถglich?", tip:["Ja; Ziel wahren; anrechenbar (ยง2(3) BBiG)."]}
  ];
  
  const BANK_PRUEF = [
    { ref:"P1", q:"Zwischenprรผfung ยง48?", tip:["Wissensstand; Zulassung (ยง43)."]},
    { ref:"P2", q:"Ausbildungsende ยง21?", tip:["Ablauf Zeit oder Bekanntgabe Bestehen."]},
    { ref:"P3", q:"Zulassung: Nachweis?", tip:["Kann gefordert werden; fehlend = Ausschluss."]},
    { ref:"P4", q:"Nachteilsausgleich: Beispiele?", tip:["Zeit, Hilfsmittel, angepasste Aufgaben."]},
    { ref:"P5", q:"Prรผfungsrecht: Prinzipien?", tip:["Rechtsgrundlagen, Gleichbehandlung, Verhรคltnismรครigkeit."]},
    { ref:"P6", q:"ยง15 BBiG: Prรผfung?", tip:["Teilnahme; Vortag schriftliche Abschlussprรผfung."]},
    { ref:"P7", q:"Wiederholung: Mรถglich?", tip:["Ja; Verlรคngerung ยง8(2) mรถglich."]},
    { ref:"P8", q:"Doku Vorbereitung?", tip:["Plan, Nachweise, Beurteilungen, Berichtsheft."]},
    { ref:"P9", q:"Verlรคngerung: Wann?", tip:["Nichtbestehen/besondere Fรคlle (ยง8(2))."]},
    { ref:"P10", q:"Versetzung: Zulรคssig?", tip:["Ja, wenn ausbildungsdienlich/zumutbar (ยง14)."]}
  ];
  
  const BANK_DS = [
    { ref:"D1", q:"DSGVO: Drei Grundsรคtze?", tip:["Zweckbindung, Datenminimierung, Transparenz."]},
    { ref:"D2", q:"KI-Vorsicht?", tip:["Keine personenbezogenen/sensiblen Daten."]},
    { ref:"D3", q:"Betriebsgeheimnis: Umgang?", tip:["Verschwiegenheit; Schulung."]},
    { ref:"D4", q:"Doku DSGVO?", tip:["VVT, TOMs, Schulungsnachweise."]},
    { ref:"D5", q:"Foto/Video: Beachten?", tip:["Einwilligung/Betroffenenrechte."]},
    { ref:"D6", q:"AGG Recruiting: Fehler?", tip:["Diskriminierung (Alter/Geschlecht/Religion)."]},
    { ref:"D7", q:"SoMe Screening: Achten auf?", tip:["Datenschutz/Erforderlichkeit/Transparenz."]},
    { ref:"D8", q:"Bewerbungen: Aufbewahrung?", tip:["6 Monate (AGG), dann lรถschen."]},
    { ref:"D9", q:"Datenschutz: Pflichten?", tip:["DSGVO/BDSG; Unterweisung dokumentieren."]},
    { ref:"D10", q:"Insolvenz: Was passiert?", tip:["Fortfรผhrung/Anschluss/IHK; ggf. Insolvenzgeld."]}
  ];
  
  const BANK_SYS = [
    { ref:"S1", q:"BIBB: Aufgaben?", tip:["Beratung, Forschung (ยง90 BBiG)."]},
    { ref:"S2", q:"AO: Wer erlรคsst?", tip:["Fachministerien/BBiG; BIBB wirkt mit."]},
    { ref:"S3", q:"Lernorte ยง2?", tip:["Betrieb, Schule, ggf. weitere."]},
    { ref:"S4", q:"Rahmenplan: Funktion?", tip:["Zeitlich-sachl. Struktur; Mindestinhalte."]},
    { ref:"S5", q:"Kammern: Rolle?", tip:["Zustรคndige Stelle: Eintragung, Beratung, Prรผfungen."]},
    { ref:"S6", q:"Nicht tarifgebunden: Vergรผtung?", tip:["Anlehnung Tarife; MiAV beachten."]},
    { ref:"S7", q:"Rechtsquellen: Hierarchie?", tip:["EU/GG โ Gesetze โ Tarif โ BV โ Vertrag."]},
    { ref:"S8", q:"Nebentรคtigkeit: Norm?", tip:["Art. 12 GG."]},
    { ref:"S9", q:"ยง1 BBiG: Sรคulen?", tip:["Vorbereitung, Ausbildung, Fortbildung, Umschulung."]},
    { ref:"S10", q:"ยง28 BBiG: Durchfรผhrung?", tip:["Eignung; moderne Formen ok."]}
  ];

  const CLUSTERS = [
    { key:"core", title:"Kern (V1-V10)", icon:"layers", data:BANK_CORE },
    { key:"bas", title:"Grundlagen (G1-G10)", icon:"users", data:BANK_BASICS },
    { key:"recht", title:"Recht (R1-R10)", icon:"scale", data:BANK_RECHT },
    { key:"az", title:"Arbeitszeit (A1-A10)", icon:"clock", data:BANK_ARBZ },
    { key:"orga", title:"Organisation (O1-O10)", icon:"calendar", data:BANK_ORGA },
    { key:"bet", title:"Beteiligte (B1-B10)", icon:"id-card", data:BANK_BETEILIGTE },
    { key:"mitb", title:"Mitbestimmung (M1-M10)", icon:"handshake", data:BANK_MITBEST },
    { key:"pruef", title:"Prรผfung (P1-P10)", icon:"file-check", data:BANK_PRUEF },
    { key:"ds", title:"Datenschutz (D1-D10)", icon:"shield", data:BANK_DS },
    { key:"sys", title:"System (S1-S10)", icon:"building", data:BANK_SYS }
  ];

  const LAW_INDEX = [
    { law:"BBiG", para:"ยง11", tags:["vertrag"], excerpt:"Niederschrift wesentlicher Inhalte.", link:"https://www.gesetze-im-internet.de/bbig_2005/BBiG.pdf" },
    { law:"BBiG", para:"ยง20", tags:["probezeit"], excerpt:"Probezeit 1-4 Monate.", link:"https://www.gesetze-im-internet.de/bbig_2005/BBiG.pdf" },
    { law:"BBiG", para:"ยง15", tags:["freistellung"], excerpt:"Freistellung; Wegezeiten.", link:"https://www.gesetze-im-internet.de/bbig_2005/BBiG.pdf" },
    { law:"BBiG", para:"ยง17", tags:["vergรผtung"], excerpt:"Angemessene Vergรผtung; MiAV.", link:"https://www.gesetze-im-internet.de/bbig_2005/BBiG.pdf" },
    { law:"JArbSchG", para:"ยง8-15", tags:["arbeitszeit"], excerpt:"Arbeitszeit, Pausen, Ruhezeit 12h.", link:"https://www.gesetze-im-internet.de/jarbschg/JArbSchG.pdf" },
    { law:"ArbZG", para:"ยง3-5", tags:["arbeitszeit"], excerpt:"8h/Tag, Pausen, 11h Ruhe.", link:"https://www.gesetze-im-internet.de/arbzg/BJNR117100994.html" }
  ];

  let currentUsername = localStorage.getItem(CURRENT_USER_KEY);
  let activeKey = "core";
  let answersByRef = {};
  let selectedByRef = {};
  let bookmarks = {};

  // ===== LOGIN SYSTEM =====
  function showLogin() {
    loginScreen.style.display = "flex";
    mainApp.style.display = "none";
    usernameInput.focus();
  }

  function hideLogin() {
    loginScreen.style.display = "none";
    mainApp.style.display = "block";
    currentUserDisplay.textContent = currentUsername;
    if (window.lucide) lucide.createIcons();
  }

  loginForm.addEventListener("submit", (e) => {
    e.preventDefault();
    
    if (!disclaimerCheck.checked) {
      toast("โ Bitte bestรคtige den fachlichen Hinweis.");
      return;
    }
    
    const username = usernameInput.value.trim();
    
    if (username.length < 2) {
      toast("โ Bitte gib mindestens 2 Zeichen ein.");
      return;
    }
    
    currentUsername = username;
    localStorage.setItem(CURRENT_USER_KEY, username);
    hideLogin();
    initApp();
  });

  logoutBtn.addEventListener("click", () => {
    if (confirm("Mรถchtest du dich wirklich abmelden?\n\nDein Fortschritt bleibt gespeichert.")) {
      localStorage.removeItem(CURRENT_USER_KEY);
      location.reload();
    }
  });

  if (!currentUsername) {
    showLogin();
    return;
  } else {
    hideLogin();
  }

  // ===== MAIN APP =====
  function initApp() {
    try {
      const s = JSON.parse(localStorage.getItem(getStorageKey("STATE")) || "{}");
      if (s && typeof s === 'object') {
        activeKey = s.activeKey || "core";
        answersByRef = s.answersByRef || {};
        selectedByRef = s.selectedByRef || {};
      }
    } catch {}
    
    try {
      bookmarks = JSON.parse(localStorage.getItem(getStorageKey("BOOKMARKS")) || "{}");
    } catch {}

    let startTs = Date.now();
    setInterval(() => {
      const s = Math.floor((Date.now() - startTs) / 1000);
      timerEl.textContent = `${String(Math.floor(s/60)).padStart(2,"0")}:${String(s%60).padStart(2,"0")}`;
    }, 1000);

    const savedTheme = localStorage.getItem("pro_theme") || "light";
    if (savedTheme === "dark") document.documentElement.classList.add("dark");
    themeToggle.addEventListener("click", () => {
      document.documentElement.classList.toggle("dark");
      localStorage.setItem("pro_theme", document.documentElement.classList.contains("dark") ? "dark" : "light");
      if (window.lucide) lucide.createIcons();
    });

    renderTabs();
    renderQuestions();
    setupEventListeners();
  }

  function toast(msg) {
    toastEl.textContent = msg;
    toastEl.style.display = "block";
    clearTimeout(toast._t);
    toast._t = setTimeout(() => toastEl.style.display = "none", 3000);
  }

  function saveState() {
    try {
      localStorage.setItem(getStorageKey("STATE"), JSON.stringify({
        ts: Date.now(),
        activeKey,
        answersByRef,
        selectedByRef
      }));
    } catch {}
  }

  let saveTimeout;
  function saveStateThrottled() {
    clearTimeout(saveTimeout);
    saveTimeout = setTimeout(saveState, 400);
  }

  function currentQuestions() {
    return CLUSTERS.find(x => x.key === activeKey)?.data || [];
  }

  function renderTabs() {
    tabs.innerHTML = "";
    clusterSelect.innerHTML = "";
    CLUSTERS.forEach(c => {
      const b = document.createElement("button");
      b.type = "button";
      b.className = "tab";
      b.setAttribute("aria-selected", c.key === activeKey ? "true" : "false");
      b.innerHTML = `<i data-lucide="${c.icon}"></i><span>${c.title}</span>`;
      b.addEventListener("click", () => {
        activeKey = c.key;
        renderTabs();
        renderQuestions();
        saveStateThrottled();
      });
      tabs.appendChild(b);

      const opt = document.createElement("option");
      opt.value = c.key;
      opt.textContent = c.title;
      if (c.key === activeKey) opt.selected = true;
      clusterSelect.appendChild(opt);
    });
    if (window.lucide) lucide.createIcons();
  }

  clusterSelect.addEventListener("change", (e) => {
    activeKey = e.target.value;
    renderTabs();
    renderQuestions();
    saveStateThrottled();
  });

  function renderQuestions() {
    [...form.querySelectorAll("section[data-ref]")].forEach(sec => {
      const ref = sec.getAttribute("data-ref");
      const ta = sec.querySelector("textarea");
      const cb = sec.querySelector("input[type='checkbox'][data-select]");
      if (ta) answersByRef[ref] = ta.value;
      if (cb) selectedByRef[ref] = cb.checked;
    });

    const QUESTIONS = currentQuestions();
    form.innerHTML = "";
    
    QUESTIONS.forEach((item, idx) => {
      const isMarked = !!bookmarks[item.ref];
      const sec = document.createElement("section");
      sec.className = "card q-card";
      sec.setAttribute("data-ref", item.ref);
      
      sec.innerHTML = `
        <button type="button" class="bookmark ${isMarked?'active':''}" data-bm="${item.ref}">
          <i data-lucide="bookmark" style="width:18px;height:18px"></i>
        </button>
        <div style="display:flex;align-items:center;gap:10px;margin-bottom:12px">
          <input type="checkbox" data-select="${idx}" style="width:18px;height:18px;cursor:pointer;accent-color:var(--primary)">
          <span class="badge">${item.ref}</span>
        </div>
        <h3 style="font-weight:700;font-size:15px;margin-bottom:12px;line-height:1.5">${item.q}</h3>
        <details class="tip">
          <summary style="cursor:pointer;font-weight:600;font-size:13px;display:flex;align-items:center;gap:8px">
            <i data-lucide="lightbulb" style="width:16px;height:16px"></i>
            Musterlรถsung
          </summary>
          <div style="margin-top:12px;font-size:13px;line-height:1.7">
            ${(item.tip||[]).map(t=>`<p style="margin-bottom:8px">โข ${t}</p>`).join("")}
          </div>
        </details>
        <textarea rows="5" style="width:100%;margin-top:14px;padding:14px;border-radius:var(--radius);border:1px solid var(--border);font-size:14px;line-height:1.6;font-family:inherit;resize:vertical" placeholder="Deine Antwort โฆ"></textarea>
      `;
      
      form.appendChild(sec);

      const ta = sec.querySelector("textarea");
      const cb = sec.querySelector("input[data-select]");
      if (answersByRef[item.ref]) ta.value = answersByRef[item.ref];
      if (selectedByRef[item.ref] != null) cb.checked = !!selectedByRef[item.ref];

      ta.addEventListener("input", () => {
        answersByRef[item.ref] = ta.value;
        updateProgress();
        saveStateThrottled();
      });
      
      cb.addEventListener("change", () => {
        selectedByRef[item.ref] = cb.checked;
        updateSelCount();
        saveStateThrottled();
      });

      sec.querySelector("[data-bm]").addEventListener("click", () => {
        bookmarks[item.ref] = !bookmarks[item.ref];
        if (!bookmarks[item.ref]) delete bookmarks[item.ref];
        localStorage.setItem(getStorageKey("BOOKMARKS"), JSON.stringify(bookmarks));
        sec.querySelector(".bookmark").classList.toggle("active", !!bookmarks[item.ref]);
        updateBookmarkCount();
      });
    });

    if (window.lucide) lucide.createIcons();
    updateSelCount();
    updateProgress();
    updateBookmarkCount();
  }

  function updateSelCount() {
    const n = Object.entries(selectedByRef).filter(([r,v]) => v).length;
    selText.textContent = `${n} ausgewรคhlt`;
  }

  function updateProgress() {
    const allRefs = currentQuestions().map(q => q.ref);
    const answered = allRefs.filter(r => (answersByRef[r]||"").trim().length > 0).length;
    const total = allRefs.length || 1;
    progressBar.style.width = Math.round((answered/total)*100) + "%";
    progressTxt.textContent = `${answered} / ${total}`;
  }

  function updateBookmarkCount() {
    const n = Object.keys(bookmarks).length;
    if (n > 0) {
      bookmarkCount.textContent = n;
      bookmarkCount.style.display = "inline-flex";
    } else {
      bookmarkCount.style.display = "none";
    }
  }

  function setupEventListeners() {
    // Submit Button - ROBUST (akzeptiert JSON UND reinen Text!)
    submitBtn.addEventListener("click", async () => {
      const QUESTIONS = currentQuestions();
      let selRefs = QUESTIONS.map(q => q.ref).filter(r => selectedByRef[r]);
      
      if (selRefs.length === 0) {
        selRefs = QUESTIONS.map(q => q.ref).filter(r => (answersByRef[r]||"").trim().length > 0);
        if (selRefs.length === 0) {
          toast("โ Bitte wรคhle mind. eine Frage aus.");
          return;
        }
      }

      const list = selRefs.map((ref, i) => {
        const q = QUESTIONS.find(x => x.ref === ref);
        return { nr: i+1, ref: q.ref, question: q.q, answer: (answersByRef[ref]||"").trim() };
      });

      resultWrap.classList.remove("hidden");
      aiResult.innerHTML = '<div style="color:var(--ink-muted)">KI erstellt Feedback โฆ</div>';
      submitBtn.disabled = true;
      const oldHTML = submitBtn.innerHTML;
      submitBtn.innerHTML = '<span style="display:inline-block;width:16px;height:16px;border:2px solid currentColor;border-right-color:transparent;border-radius:50%;animation:spin .6s linear infinite"></span> Prรผfen โฆ';

      try {
        const response = await fetch(WEBHOOK_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ 
            prompt: `Beurteile wohlwollend folgende BBiG-Antworten:\n\n${list.map(a => `**Q${a.nr} (${a.ref}):** ${a.question}\n**Antwort:** ${a.answer || "(leer)"}`).join("\n\n")}`
          })
        });
        
        if (!response.ok) throw new Error(`HTTP ${response.status}`);
        
        const contentType = response.headers.get("content-type");
        let result;
        
        // ROBUST: Akzeptiert JSON UND reinen Text!
        if (contentType && contentType.includes("application/json")) {
          const data = await response.json();
          result = data.answer || data.content || data.result || data.text || JSON.stringify(data);
        } else {
          result = await response.text();
        }
        
        aiResult.innerHTML = window.marked ? marked.parse(result) : result;
        
        const hist = JSON.parse(localStorage.getItem(getStorageKey("HISTORY")) || "[]");
        hist.push({ ts: Date.now(), html: aiResult.innerHTML });
        localStorage.setItem(getStorageKey("HISTORY"), JSON.stringify(hist));
        
        window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
        toast("โ Feedback erhalten!");
        
      } catch (e) {
        aiResult.innerHTML = `<div style="color:#E53935;font-weight:600">โ Fehler: ${e.message}</div>`;
        toast("โ Fehler beim KI-Feedback.");
      } finally {
        submitBtn.disabled = false;
        submitBtn.innerHTML = oldHTML;
        if (window.lucide) lucide.createIcons();
      }
    });

    // Reset Button
    resetBtn.addEventListener("click", () => {
      if (!confirm("โ Alle Eingaben im Cluster zurรผcksetzen?")) return;
      currentQuestions().forEach(q => {
        delete answersByRef[q.ref];
        delete selectedByRef[q.ref];
      });
      renderQuestions();
      saveState();
      resultWrap.classList.add("hidden");
      aiResult.innerHTML = "";
      toast("๐ Cluster zurรผckgesetzt.");
      window.scrollTo({ top: 0, behavior: "smooth" });
    });

    // Bookmarks Modal
    bookmarksBtn.addEventListener("click", () => {
      bmBackdrop.classList.add("open");
      bmModal.classList.add("open");
      const refs = Object.keys(bookmarks).filter(r => bookmarks[r]);
      bmList.innerHTML = refs.length ? "" : '<div style="text-align:center;color:var(--ink-muted);padding:24px">Keine Markierungen.</div>';
      refs.forEach(ref => {
        const ans = (answersByRef[ref] || "").trim();
        const div = document.createElement("div");
        div.className = "card";
        div.style.padding = "16px";
        div.innerHTML = `<div style="font-weight:700;margin-bottom:6px">${ref}</div><div style="font-size:13px;color:var(--ink-muted)">${ans ? ans.slice(0,200)+"โฆ" : "(keine Antwort)"}</div>`;
        bmList.appendChild(div);
      });
    });
    bmBackdrop.addEventListener("click", () => { bmBackdrop.classList.remove("open"); bmModal.classList.remove("open"); });
    bmClose.addEventListener("click", () => { bmBackdrop.classList.remove("open"); bmModal.classList.remove("open"); });

    // Quicklook Modal
    quickBtn.addEventListener("click", () => {
      qlBackdrop.classList.add("open");
      qlModal.classList.add("open");
      qlSearch.value = "";
      renderQuicklook("");
      qlSearch.focus();
    });
    qlBackdrop.addEventListener("click", () => { qlBackdrop.classList.remove("open"); qlModal.classList.remove("open"); });
    qlClose.addEventListener("click", () => { qlBackdrop.classList.remove("open"); qlModal.classList.remove("open"); });
    qlSearch.addEventListener("input", (e) => renderQuicklook(e.target.value));
    
    function renderQuicklook(query) {
      const q = (query || "").toLowerCase().trim();
      const list = q ? LAW_INDEX.filter(x => x.para.toLowerCase().includes(q) || x.law.toLowerCase().includes(q) || x.tags.some(t => t.includes(q))) : LAW_INDEX;
      qlList.innerHTML = "";
      if (!list.length) {
        qlList.innerHTML = '<div style="text-align:center;color:var(--ink-muted);padding:24px">Keine Treffer.</div>';
        return;
      }
      list.forEach(x => {
        const row = document.createElement("div");
        row.className = "card";
        row.style.padding = "16px";
        row.innerHTML = `<div style="display:flex;justify-content:space-between;margin-bottom:6px"><div style="font-weight:700">${x.law} ${x.para}</div><a class="btn" href="${x.link}" target="_blank" style="padding:4px 10px;font-size:12px">PDF</a></div><div style="font-size:13px;color:var(--ink-muted)">${x.excerpt}</div>`;
        qlList.appendChild(row);
      });
    }

    // History Modal
    historyBtn.addEventListener("click", () => {
      histBackdrop.classList.add("open");
      histModal.classList.add("open");
      const arr = JSON.parse(localStorage.getItem(getStorageKey("HISTORY")) || "[]");
      histList.innerHTML = "";
      if (!arr.length) {
        histList.innerHTML = '<div style="text-align:center;color:var(--ink-muted);padding:24px">Noch keine Eintrรคge.</div>';
        return;
      }
      arr.slice().reverse().forEach(h => {
        const d = document.createElement("div");
        d.className = "card";
        d.style.padding = "16px";
        d.innerHTML = `<div style="font-size:11px;color:var(--ink-muted);margin-bottom:6px">${new Date(h.ts).toLocaleString()}</div><div style="font-size:13px">${window.marked ? marked.parse(h.html) : h.html}</div>`;
        histList.appendChild(d);
      });
    });
    histBackdrop.addEventListener("click", () => { histBackdrop.classList.remove("open"); histModal.classList.remove("open"); });
    histClose.addEventListener("click", () => { histBackdrop.classList.remove("open"); histModal.classList.remove("open"); });
  }
});
</script>
</body>
</html>  
<body>
<div id="loginScreen">
<div class="login-container">
<div class="login-logo">
<i data-lucide="graduation-cap" style="width:44px;height:44px;color:#fff"></i>
</div>
<div class="login-card">
<h1 style="text-align:center;font-size:28px;font-weight:800;color:var(--primary);margin-bottom:8px">BBiG-Quiz Professional</h1>
<p style="text-align:center;font-size:14px;color:var(--ink-muted);margin-bottom:32px">100 Fragen โข 10 Cluster โข KI-Feedback</p>
<div class="disclaimer-box">
<h4><i data-lucide="shield-alert" style="width:16px;height:16px"></i>Fachlicher Hinweis</h4>
<p>Die KI-Prรผfung unterstรผtzt beim Lernen. Ergebnisse sind zu prรผfen. <strong>Keine personenbezogenen Daten eingeben.</strong></p>
<label><input id="disclaimerCheck" type="checkbox"><span>Ich habe den Hinweis gelesen</span></label>
</div>
<form id="loginForm">
<div class="input-group">
<label for="usernameInput"><i data-lucide="user" style="width:14px;height:14px;display:inline-block;vertical-align:middle;margin-right:4px"></i>Dein Name</label>
<input id="usernameInput" type="text" placeholder="z.B. Max Mustermann" maxlength="50" required>
</div>
<button type="submit" class="btn btn-blue" style="width:100%;padding:14px">
<i data-lucide="log-in" style="width:20px;height:20px"></i>Quiz starten
</button>
</form>
<div class="login-features">
<div class="feature-item"><i data-lucide="check-circle"></i><span>100 Fragen</span></div>
<div class="feature-item"><i data-lucide="brain"></i><span>KI-Feedback</span></div>
<div class="feature-item"><i data-lucide="bookmark"></i><span>Autosave</span></div>
<div class="feature-item"><i data-lucide="shield-check"></i><span>Datenschutz</span></div>
</div>
<p style="text-align:center;font-size:11px;color:var(--ink-muted);margin-top:24px;line-height:1.6">Fortschritt wird lokal gespeichert.<br>Keine Registrierung erforderlich.</p>
</div>
</div>
</div>
<div id="mainApp" style="display:none">
<section class="hero">
<div class="container">
<h1>BBiG-Quiz Professional</h1>
<p>100 Fragen โข 10 Cluster โข Intelligentes KI-Feedback</p>
</div>
</section>
<header style="position:sticky;top:0;z-index:40;background:var(--surface);border-bottom:1px solid var(--border);box-shadow:var(--shadow-sm)">
<div class="container" style="padding:16px 20px">
<div style="display:flex;justify-content:space-between;align-items:center;gap:16px;flex-wrap:wrap">
<div style="display:flex;align-items:center;gap:14px">
<div style="width:44px;height:44px;border-radius:var(--radius);background:linear-gradient(135deg,var(--primary),var(--primary-dark));display:grid;place-items:center">
<i data-lucide="graduation-cap" style="width:26px;height:26px;color:#fff"></i>
</div>
<div>
<h2 style="font-size:17px;font-weight:700;margin-bottom:2px">BBiG-Quiz Professional</h2>
<p style="font-size:11px;color:var(--ink-muted)">Angemeldet als: <strong id="currentUser" style="color:var(--primary)">-</strong></p>
</div>
</div>
<div style="display:flex;gap:10px;flex-wrap:wrap">
<button id="quickBtn" class="btn"><i data-lucide="search" style="width:16px;height:16px"></i> ยง-Quicklook</button>
<button id="bookmarksBtn" class="btn"><i data-lucide="bookmark" style="width:16px;height:16px"></i><span id="bookmarkCount" class="badge" style="display:none">0</span></button>
<button id="historyBtn" class="btn"><i data-lucide="history" style="width:16px;height:16px"></i></button>
<button id="logoutBtn" class="btn btn-ghost" title="Abmelden"><i data-lucide="log-out" style="width:16px;height:16px"></i></button>
<button id="themeToggle" class="btn btn-ghost"><i data-lucide="moon" style="width:16px;height:16px"></i></button>
</div>
</div>
<div style="margin-top:16px">
<div class="card" style="padding:14px">
<div id="tabs" class="tabs"></div>
<select id="clusterSelect" style="width:100%;padding:10px;border-radius:var(--radius);border:1px solid var(--border);font-weight:600"></select>
</div>
</div>
</div>
</header>
<section class="container" style="margin-top:20px">
<div class="card" style="padding:18px;display:flex;align-items:center;gap:14px">
<i data-lucide="target" style="width:22px;height:22px;color:var(--primary);flex-shrink:0"></i>
<div style="flex:1">
<div style="display:flex;justify-content:space-between;font-size:11px;font-weight:700;color:var(--ink-muted);margin-bottom:10px;text-transform:uppercase;letter-spacing:.5px">
<span id="progressText">0 / 0</span>
<span id="selText">0 ausgewรคhlt</span>
</div>
<div class="progress-outer"><div id="progressBar" class="progress-inner" style="width:0%"></div></div>
</div>
<time id="timer" style="font-size:14px;font-family:monospace;font-weight:700;color:var(--ink-muted);min-width:50px;text-align:right">00:00</time>
</div>
</section>
<main class="container" style="margin:20px auto 120px">
<form id="form" style="display:grid;gap:20px"></form>
<section id="resultWrap" class="hidden" style="margin-top:24px">
<div class="card" style="padding:24px;border:2px solid var(--success)">
<h3 style="font-size:18px;font-weight:800;color:var(--success);margin-bottom:16px">๐ฏ Gesamtauswertung</h3>
<article id="aiResult" style="font-size:14px;line-height:1.8"></article>
</div>
</section>
</main>
<div class="sticky-actions">
<div class="container" style="display:flex;justify-content:space-between;align-items:center;gap:14px;flex-wrap:wrap">
<div style="display:flex;gap:10px">
<a class="btn" href="https://www.gesetze-im-internet.de/bbig_2005/BBiG.pdf" target="_blank"><i data-lucide="book-open" style="width:16px;height:16px"></i> BBiG</a>
<a class="btn" href="https://www.gesetze-im-internet.de/jarbschg/JArbSchG.pdf" target="_blank"><i data-lucide="shield" style="width:16px;height:16px"></i> JArbSchG</a>
</div>
<div style="display:flex;gap:10px">
<button id="submitBtn" class="btn btn-primary" style="padding:12px 24px"><i data-lucide="send" style="width:18px;height:18px"></i> KI-Feedback</button>
<button id="resetBtn" class="btn"><i data-lucide="rotate-ccw" style="width:18px;height:18px"></i> Reset</button>
</div>
</div>
</div>
<div id="toast"></div>
<div id="bmBackdrop" class="modal-backdrop"></div>
<div id="bmModal" class="modal"><div class="panel card" style="padding:28px"><div style="display:flex;justify-content:space-between;margin-bottom:20px"><h3 style="font-weight:700;font-size:18px">๐ Markierte Fragen</h3><button id="bmClose" class="btn btn-ghost"><i data-lucide="x" style="width:20px;height:20px"></i></button></div><div id="bmList" style="max-height:70vh;overflow:auto;display:grid;gap:14px"></div></div></div>
<div id="qlBackdrop" class="modal-backdrop"></div>
<div id="qlModal" class="modal"><div class="panel card" style="padding:28px"><div style="display:flex;justify-content:space-between;margin-bottom:20px"><h3 style="font-weight:700;font-size:18px">๐ ยง-Quicklook</h3><button id="qlClose" class="btn btn-ghost"><i data-lucide="x" style="width:20px;height:20px"></i></button></div><input id="qlSearch" type="search" placeholder="Begriff โฆ" style="width:100%;padding:12px 16px;border-radius:var(--radius);border:1px solid var(--border);margin-bottom:16px"><div id="qlList" style="max-height:65vh;overflow:auto;display:grid;gap:14px"></div></div></div>
<div id="histBackdrop" class="modal-backdrop"></div>
<div id="histModal" class="modal"><div class="panel card" style="padding:28px"><div style="display:flex;justify-content:space-between;margin-bottom:20px"><h3 style="font-weight:700;font-size:18px">๐ Historie</h3><button id="histClose" class="btn btn-ghost"><i data-lucide="x" style="width:20px;height:20px"></i></button></div><div id="histList" style="max-height:70vh;overflow:auto;display:grid;gap:14px"></div></div></div>
<footer style="font-size:11px;color:var(--ink-muted);background:var(--surface-alt);border-top:1px solid var(--border);padding:28px 0">
<div class="container" style="text-align:center;line-height:1.7">Diese Anwendung nutzt KI (OpenAI via Make.com). Keine personenbezogenen Daten erfassen. Jegliche Haftung ausgeschlossen.</div>
</footer>
</div>
